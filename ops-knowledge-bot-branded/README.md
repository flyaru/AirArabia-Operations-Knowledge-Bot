# Operations Knowledge Bot — Arwa & Air Arabia Edition

This repository contains a **self‑hosted** retrieval‑augmented question‑answering system for aviation operations.  It lets staff ask natural language questions about internal manuals (Ground Operations Manual, IATA rules, station SOPs) and receive short answers with page‑level citations.

Unlike cloud solutions, this starter is designed to be **completely free**.  It uses a local vector database (Chroma) and a free open‑source embedding model (`all‑MiniLM‑L6‑v2`).  You can optionally enable answer synthesis with OpenAI; without a key, the bot still returns concise extractive answers.

## Arwa Travel & Air Arabia Customisation

This version has been tailored for **Arwa Travel Group** and **Air Arabia**.  The web interface includes:

* A red accent colour (`#D10028`) matching Arwa/Air Arabia branding.
* A top bar with placeholders for your logos (`airarabia-logo.png` and `arwa-logo.png`).  Replace the files in `web/assets/` with your high‑resolution logos (PNG preferred).
* A footer with contact details:

  • Phone: `+966 555 748 179` / `+966 532 004 264`

  • E‑mail: `contactus@arwatravelksa.com`

  • Website: `www.flyaru.com`

You can adjust colours and fonts by editing `web/index.html`.

## Quick Start

### 1. Environment

Install Python 3.10 or newer.  On Windows, you can use PowerShell:

```powershell
python -m venv .venv
.\.venv\Scripts\Activate
pip install -r requirements.txt
```

On Linux or macOS:

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 2. Add your manuals

Place your GOM, IATA manuals and station SOPs as **PDF files** into the `data/` directory.  Text‑based PDFs are preferred; image‑only PDFs should be OCR’d beforehand.

### 3. Ingest your knowledge

Run the ingestion script to extract text, split it into chunks and embed it into a local Chroma database:

```bash
python ingestion.py
```

This will create a `storage/` directory with the embedded documents.  You only need to run ingestion again when you add new or updated PDFs.

### 4. (Optional) Enable LLM synthesis

Copy `.env.example` to `.env` and set `OPENAI_API_KEY` to your OpenAI key.  With a key, answers will be generated by an OpenAI model (default `gpt-4o-mini`).  Without a key, the API returns concise extractive snippets with citations.

### 5. Run the API and web UI

Start the FastAPI server:

```bash
uvicorn server.main:app --reload
```

Visit [http://127.0.0.1:8000/](http://127.0.0.1:8000/) to use the web interface, or [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) for an interactive API explorer.

### 6. Deploy for free

A `render.yaml` and `Procfile` are included for easy deployment on [Render](https://render.com/)’s free web service.  Push this folder to GitHub, then create a new **Web Service** on Render with the following:

* **Build command:** `pip install -r requirements.txt`

* **Start command:** `uvicorn server.main:app --host 0.0.0.0 --port $PORT`

Add `OPENAI_API_KEY` in Render’s environment variables if you want synthesized answers.

## Files

```
ops-knowledge-bot/
├── README.md           – Documentation (this file)
├── requirements.txt    – Python package dependencies
├── .env.example        – Template environment variables
├── data/               – Place your PDF manuals here
├── storage/            – Created after ingestion to store vectors
├── ingestion.py        – Extracts & embeds PDF text into Chroma
├── rag.py              – Utility functions for embedding and retrieval
└── server/
    ├── __init__.py
    └── main.py         – FastAPI app exposing /ask and serving the UI
└── web/
    ├── index.html      – Branded web interface
    └── assets/
        ├── airarabia-logo.png  – Replace with Air Arabia logo
        └── arwa-logo.png       – Replace with Arwa Travel logo
├── render.yaml         – Render deployment configuration
└── Procfile            – Procfile for other PaaS providers
```

## Language Support

The system detects whether your question is in English or Arabic and returns an answer in the same language.  If no `OPENAI_API_KEY` is provided, the answers are purely extractive (multiple bullet points with citations).  When a key is set, answers are synthesized using OpenAI and formatted neatly with a short “Key refs:” section listing the cited pages.